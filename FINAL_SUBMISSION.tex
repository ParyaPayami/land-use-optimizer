\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{url}

\modulolinenumbers[5]

\journal{Computers, Environment and Urban Systems}

\bibliographystyle{elsarticle-num}

\begin{document}

\begin{frontmatter}

\title{PIMALUOS: An Open-Source Physics-Informed Multi-Agent Framework for Urban Land-Use Optimization}

\author[nus]{Parya Payami\corref{corresponding}}
\ead{ppayami@uwm.edu}
\cortext[corresponding]{Corresponding author}

\affiliation[nus]{organization={School of Architecture and Urban Planning, University of Wisconsin Milwaukee},
            city={Milwaukee},
            state={WI},
            country={USA}}

\begin{abstract}
Urban planning stands at a crossroads. As cities grapple with climate change, housing crises, and aging infrastructure, the traditional "siloed" approach to planning---where design, regulation, and engineering happen in isolation---is no longer sufficient. We introduce PIMALUOS (Physics-Informed Multi-Agent Land-Use Optimization Software), a unified computational framework that breaks these silos. By integrating Graph Neural Networks (GNNs) for spatial reasoning, Large Language Models (LLMs) for automated regulatory compliance, and Multi-Agent Reinforcement Learning (MARL) for stakeholder negotiation, PIMALUOS offers a comprehensive "Sense-Reason-Verify" pipeline for the modern city. We demonstrate this system on 42,000 parcels in Manhattan, generating valid, optimized land-use plans that satisfy strict zoning laws and infrastructure constraints while balancing the competing needs of developers, residents, and environmentalists. Our experiments show that PIMALUOS outperforms traditional heuristic baselines by over 2.0\% in economic value without a single regulatory violation. This is not just a tool; it is a blueprint for the future of algorithmic urban governance.
\end{abstract}

\begin{keyword}
Urban planning \sep Graph neural networks \sep Multi-agent reinforcement learning \sep Large language models \sep Digital twin \sep Open-source software
\end{keyword}

\end{frontmatter}

\linenumbers

%% ============================================================================
%% INTRODUCTION
%% ============================================================================

\section{Introduction}

The modern city is a system of systems \cite{batty2013new}---a complex interplay of physical infrastructure, legal regulations, and human aspirations. Yet, the tools we use to plan these cities remain fragmented. Traffic engineers simulate flow, zoning officials check compliance, and developers optimize financial models, often with little cross-communication. This fragmentation leads to inefficiencies, unintended consequences, and a planning process that is reactive rather than proactive.

We argue that the convergence of three powerful technologies---Graph Neural Networks (GNNs), Large Language Models (LLMs), and Multi-Agent Reinforcement Learning (MARL)---offers a path to a unified urban science \cite{wang2023urban,zheng2023spatial}. GNNs allow us to model the city as it truly is: a graph of interconnected parcels sharing space, views, and infrastructure. LLMs unlock the vast, unstructured knowledge contained in legal codes, turning zoning text into computable constraints. MARL provides the agents to negotiate the inevitable trade-offs between stakeholders.

\begin{figure}[t]
    \centering
    \includegraphics[width=1.0\textwidth]{results/figures/system_ui.png}
    \caption{The PIMALUOS Interface. A unified dashboard integrates real-time 3D spatial visualization (left), physics constraint feedback (top right), and multi-agent stakeholder negotiation metrics (bottom right). This platform enables planners to explore complex trade-offs in real-time.}
    \label{fig:ui}
\end{figure}

In this paper, we present PIMALUOS: a Physics-Informed Multi-Agent Land-Use Optimization Software. PIMALUOS is designed around a novel "Sense-Reason-Verify" architecture (Figure~\ref{fig:ui}):

\begin{enumerate}
    \item \textbf{Sense (Perception)}: A heterogeneous graph captures the full context of every land parcel---its neighbors, its utility connections, and its visual lines of sight.
    \item \textbf{Reason (Knowledge & Negotiation)}: LLM-powered agents extract rules directly from the city's zoning code, while stakeholder agents (representing Developers, Residents, and the Environment) negotiate optimal outcomes within those rules.
    \item \textbf{Verify (Physics)}: A digital twin loop continuously validates these plans against physics-based models of traffic, hydrology, and solar access, ensuring that "optimal" plans are also feasible.
\end{enumerate}

We validate PIMALUOS on a massive scale: the entirety of Manhattan's tax lot system. Our results show that this integrated approach can identify stable, high-value land-use configurations that human planners or single-objective algorithms miss. By releasing PIMALUOS as open-source software, we aim to provide the community with a robust foundation for the next generation of urban intelligence.

The contributions of this paper are:

\begin{enumerate}
    \item An open-source Python framework integrating GNN, LLM, physics simulation, and MARL for urban land-use optimization, released under MIT License with comprehensive documentation.
    
    \item A novel heterogeneous graph formulation for urban parcels with five edge types capturing distinct spatial relationships.
    
    \item A retrieval-augmented generation pipeline for automated extraction of zoning constraints from regulatory documents.
    
    \item A multi-agent negotiation mechanism representing five stakeholder types with distinct utility functions and awareness weights.
    
    \item A physics-in-the-loop digital twin architecture for validated land-use recommendations.
    
    \item Demonstration of the complete pipeline on Manhattan with analysis of computational requirements and scalability.
\end{enumerate}

The remainder of this paper is organized as follows. Section 2 reviews related work in open urban data science, GNNs for spatial analysis, LLMs for regulatory extraction, MARL for planning, and physics-informed machine learning. Section 3 presents the methods and implementation details. Section 4 describes the software architecture and usage. Section 5 presents a case study applying PIMALUOS to Manhattan. Section 6 discusses implications, limitations, and future directions, followed by conclusions in Section 7.


%% ============================================================================
%% RELATED WORK
%% ============================================================================

\section{Related Work}

\subsection{Open-Source Urban Data Science Tools}

The past decade has witnessed substantial growth in open-source tools for urban data science. Boeing's OSMnx \cite{boeing2017osmnx} democratized street network analysis by providing Python interfaces to download, model, analyze, and visualize networks from OpenStreetMap. The package has been widely adopted and continues active development, with version 2.0 released in November 2024 introducing substantial API improvements and performance optimizations. Biljecki and Chow \cite{biljecki2022global} developed Global Building Morphology Indicators for characterizing building geometry at scale. More recently, Ito et al. \cite{ito2025zensvi} introduced ZenSVI for integrated acquisition and processing of street view imagery, while Mahajan \cite{mahajan2024greenr} created greenR for quantifying urban greenness. F\'elix et al. \cite{felix2024biclar} developed biclaR for modeling combined public transport and cycling scenarios. The Urban Data Science Toolkit (UDST) provides UrbanSim for land-use simulation, Pandana for accessibility analysis, and related tools. Sevtsuk and Alhassan \cite{sevtsuk2025madina} published the Madina package for scalable pedestrian and bicycle network analysis.

These tools have demonstrated the value of open, reproducible urban analytics. However, they largely operate as independent modules addressing specific analytical domains. PIMALUOS builds on this foundation by providing an integration framework that connects spatial analysis, regulatory extraction, physics simulation, and optimization.

\subsection{Graph Neural Networks for Urban Spatial Analysis}

Graph neural networks have emerged as powerful tools for modeling urban systems, which naturally exhibit graph-like structure through street networks, utility grids, and spatial relationships \cite{wang2023urban}. Recent work has applied GNNs to traffic prediction \cite{jiang2022graph}, urban function classification \cite{liu2023urban}, and land-use inference \cite{yao2017sensing}. Hybrid approaches combining GNNs with deep learning have been proposed for urban planning \cite{guo2019attention}.

The heterogeneous nature of urban relationships---where parcels connect through different types of edges representing distinct semantic relationships---motivates the use of heterogeneous graph attention networks (HGATs). These architectures learn separate attention weights for each edge type, enabling the model to differentially weight spatial adjacency versus functional similarity versus regulatory coupling. Our approach extends this paradigm with five distinct edge types specifically designed for urban land-use optimization.

\subsection{Large Language Models for Urban Planning and Zoning}

Large language models are increasingly applied to urban planning contexts. LLMs can synthesize complex zoning documents, identify key rules, and allow users to extract information through natural language queries \cite{zhang2024llmzoning}. Emerging applications include automated zoning analysis tools and urban computing applications \cite{urban2025llm}. Multi-agent collaboration frameworks using LLMs \cite{dai2024simulating}

Retrieval-augmented generation (RAG) addresses LLM limitations by grounding responses in factual documents \cite{lewis2020rag}. For zoning applications, RAG enables queries against the specific regulatory text applicable to a given city, reducing hallucination and improving accuracy of extracted constraints. PIMALUOS implements a RAG pipeline using OpenAI embeddings and FAISS vector indexing to query the NYC Zoning Resolution. To ensure accessibility and reproducibility, the framework supports three LLM modes: (1) cloud APIs (OpenAI, Anthropic) with estimated costs of \$50-150 for full Manhattan analysis, (2) local models via Ollama for cost-free private operation, and (3) mock LLM for testing without API dependencies. Extracted constraints are cached to minimize repeated API calls.

\subsection{Multi-Agent Reinforcement Learning for Urban Systems}

Multi-agent reinforcement learning provides a framework for modeling complex urban systems where multiple entities with potentially conflicting objectives interact \cite{zhang2021marl}. Applications include traffic signal control \cite{chu2020marl}, autonomous vehicle coordination, and resource allocation in smart cities. More recently, consensus-based MARL frameworks have been proposed for participatory urban planning \cite{li2024consensus}.

Our approach defines five stakeholder agent types with distinct utility functions: Residents prioritize affordability and amenity access; Developers maximize floor area utilization; City Planners balance tax revenue and infrastructure efficiency; Environmentalists minimize impervious surface and maximize solar access; Equity Advocates minimize displacement and maximize equitable amenity distribution. Agents are trained using Proximal Policy Optimization (PPO) and reach consensus through iterative negotiation.

\subsection{Digital Twins and Physics-Informed Machine Learning}

Digital twins---dynamic virtual representations of physical systems---are increasingly adopted for urban management \cite{albalkhy2024digital}. Urban digital twins integrate real-time data from IoT sensors with simulation models to support scenario testing and decision-making. Physics modeling within digital twins enables simulation of environmental factors including traffic flow, stormwater runoff, air quality, and solar radiation \cite{raissi2019pinn}.

Physics-informed machine learning constrains neural network predictions to satisfy known physical laws \cite{karniadakis2021physics}. In urban contexts, this can ensure that land-use recommendations do not violate infrastructure capacity constraints discovered through simulation. PIMALUOS implements a physics-in-the-loop architecture where multi-physics simulation results are incorporated as penalty terms during GNN training, steering the model toward configurations that satisfy traffic, drainage, and solar constraints.


%% ============================================================================
%% METHODS
%% ============================================================================

\section{Methods}
\label{sec:methods}

PIMALUOS implements a modular "Sense-Reason-Verify" architecture that integrates heterogeneous graph learning, retrieval-augmented generation, multi-agent simulation, and physics-based validation. The framework is organized into four logical layers: Perception, Knowledge, Reasoning, and Verification.

\subsection{Perception Layer: Heterogeneous Graph Construction}

The Perception Layer transforms raw urban data into a structured graph representation. We model the city as a heterogeneous graph $G = (V, E, \mathcal{T}_v, \mathcal{T}_e)$, where $V$ represents land parcels.

\subsubsection{Node Features}
Each parcel node $v_i \in V$ is initialized with a 47-dimensional feature vector $\mathbf{x}_i$ containing:
\begin{itemize}
    \item \textbf{Geometry}: Lot area, frontage, depth, irregularity factor
    \item \textbf{Built Environment}: Building class, year built, units, floor area
    \item \textbf{Economics}: Assessed land/total value, tax class, recent sale price
    \item \textbf{Location}: Coordinates, borough code, block/lot IDs
\end{itemize}

\subsubsection{Edge Types}
We define five distinct edge types $\mathcal{T}_e$ to capture complex urban relationships:
\begin{enumerate}
    \item \textbf{Spatial Adjacency} ($E_{adj}$): connects physical neighbors sharing a boundary.
    \item \textbf{Visual Connectivity} ($E_{vis}$): connects parcels within line-of-sight (calculated via ray casting).
    \item \textbf{Functional Similarity} ($E_{fun}$): connects parcels with identical land-use codes (e.g., commercial-to-commercial).
    \item \textbf{Infrastructure} ($E_{inf}$): connects parcels sharing utility corridors or transit access.
    \item \textbf{Regulatory Coupling} ($E_{reg}$): connects parcels governed by the same specific zoning district regulations.
\end{enumerate}

\subsection{Knowledge Layer: RAG Constraint Extraction}

To bridge the gap between unstructured legal text and computable constraints, we employ a Retrieval-Augmented Generation (RAG) pipeline.

\begin{enumerate}
    \item \textbf{Indexing}: The NYC Zoning Resolution is chunked into semantic segments and embedded using OpenAI's `text-embedding-3-small`. Embeddings are stored in a FAISS vector index.
    \item \textbf{Retrieval}: For a given zoning district (e.g., "R6"), the system retrieves the top-$k$ relevant text chunks.
    \item \textbf{Extraction}: A Large Language Model (GPT-4 or Llama-2 via Ollama) processes retrieved chunks to extract structured constraints in JSON format:
\end{enumerate}

\begin{verbatim}
{
  "max_far": 2.43,
  "max_height": 70,
  "min_open_space_ratio": 0.2,
  "permitted_uses": ["residential", "community_facility"]
}
\end{verbatim}

These extracted constraints form the feasible action space $\mathcal{A}_i$ for each parcel.

\subsection{Reasoning Layer: GNN and MARL}

\subsubsection{Heterogeneous Graph Attention Network}
We employ a Heterogeneous Graph Attention Network (HGAT) to learn parcel embeddings. The embedding $\mathbf{h}_i^{(l+1)}$ for node $i$ of type $\phi$ is computed as:

\begin{equation}
\mathbf{h}_i^{(l+1)} = \sigma \left( \sum_{e \in \mathcal{T}_e} \sum_{j \in \mathcal{N}_i^e} \alpha_{ij}^e \mathbf{W}_e \mathbf{h}_j^{(l)} \right)
\end{equation}

where $\alpha_{ij}^e$ represents the attention weight for edge type $e$, enabling the model to learn the relative importance of spatial vs. functional vs. regulatory connections.

\subsubsection{Multi-Agent Negotiation}
The land-use assignment problem is modeled as a localized game played by five stakeholder agents for each parcel. The agents optimize modified utility functions:

\begin{itemize}
    \item \textbf{Resident}: $U_{res} = w_1(\text{Affordability}) + w_2(\text{AmenityAccess})$
    \item \textbf{Developer}: $U_{dev} = w_1(\text{ProfitMargin}) - w_2(\text{Risk})$
    \item \textbf{City Planner}: $U_{city} = w_1(\text{TaxBase}) - w_2(\text{Congestion})$
    \item \textbf{Environmentalist}: $U_{env} = w_1(\text{GreenSpace}) - w_2(\text{Runoff})$
    \item \textbf{Equity Advocate}: $U_{eq} = -w_1(\text{Displacement}) + w_2(\text{ServiceDistribution})$
\end{itemize}

Agents employ Proximal Policy Optimization (PPO) to learn negotiation strategies contributing to a Nash equilibrium.

\subsection{Verification Layer: Physics-Informed Validation}

Proposed configurations are validated against physics-based models to ensure infrastructure feasibility.

\subsubsection{Traffic Simulation (BPR)}
Link travel times are estimated using the Bureau of Public Roads function:
\begin{equation}
t_a = t_0 \left( 1 + \alpha \left( \frac{V_a}{C_a} \right)^\beta \right)
\end{equation}
Violating a congestion threshold ($V/C > 1.5$) triggers a penalty term in the reward function.

\subsubsection{Hydrology (Rational Method)}
Peak stormwater runoff $Q$ is calculated as $Q = C \cdot I \cdot A$. If the aggregate runoff exceeds the drainage capacity of the local sewer shed, a physics penalty is applied.

\subsubsection{Solar Access}
Geometric shadow casting estimates solar deprivation. Building massings are extruded, and shadow volumes are computed for the winter solstice. Configurations blocking $>50\%$ of direct sunlight to neighbors are penalized.

\subsection{Optimization Framework}
The complete system seeks a configuration $\mathbf{S}^*$ that maximizes the weighted sum of agent utilities while satisfying all hard constraints (Zoning, Physics):

\begin{equation}
\mathbf{S}^* = \arg\max_{\mathbf{S}} \sum_{i \in V} \sum_{a \in Agents} \lambda_a U_{a}(S_i) - \gamma \sum_{k \in Constraints} \max(0, g_k(\mathbf{S}))
\end{equation}

Pareto optimization via NSGA-III is used to explore the trade-off frontier between conflicting stakeholder objectives.


%% ============================================================================
%% SOFTWARE ARCHITECTURE
%% ============================================================================

\section{Software Architecture and Implementation}

\subsection{Modular Design}

PIMALUOS is implemented as a collection of 17 Python modules organized into a modular pipeline architecture. Table~\ref{tab:modules} summarizes the key modules and their functions.

\begin{table}[h]
\centering
\caption{PIMALUOS software modules}
\label{tab:modules}
\begin{tabular}{lll}
\toprule
\textbf{Module} & \textbf{Layer} & \textbf{Function} \\
\midrule
data\_loader.py & Perception & NYC MapPLUTO data acquisition \\
graph\_builder.py & Perception & Heterogeneous graph construction \\
parcel\_gnn.py & Reasoning & GNN model architecture \\
legal\_code\_parser.py & Knowledge & LLM-RAG constraint extraction \\
constraint\_validator.py & Knowledge & Zoning compliance checking \\
physics\_engine.py & Verification & Traffic, hydrology, solar simulation \\
digital\_twin.py & Verification & Physics-ML feedback loop \\
marl\_agents.py & Reasoning & Stakeholder agent definitions \\
complete\_system.py & Integration & Full pipeline orchestration \\
pareto\_optimization.py & Optimization & NSGA-II/III Pareto optimization \\
nash\_equilibrium.py & Optimization & Game-theoretic analysis \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Dependencies}

The framework leverages established open-source libraries:
\begin{itemize}
    \item \textbf{Deep Learning}: PyTorch 2.0+, PyTorch Geometric 2.3+
    \item \textbf{Geospatial}: GeoPandas, Shapely, pyproj
    \item \textbf{Optimization}: SciPy, DEAP, pymoo
    \item \textbf{Game Theory}: nashpy
    \item \textbf{LLM Integration}: LangChain, OpenAI API, ChromaDB, FAISS
    \item \textbf{Visualization}: Matplotlib, Plotly, Streamlit
\end{itemize}

\subsection{Installation and Usage}

The framework is available via pip installation:

\begin{lstlisting}[language=bash]
pip install pimaluos
\end{lstlisting}

A minimal example demonstrating the complete pipeline:

\begin{lstlisting}[language=Python]
from pimaluos import UrbanOptSystem

# Initialize system for Manhattan
system = UrbanOptSystem(data_subset_size=1000)

# Pre-train GNN on spatial features
system.pretrain_gnn(num_epochs=50)

# Train with physics feedback
system.train_with_physics_feedback(num_epochs=20)

# Optimize with multi-agent negotiation
trainer = system.optimize_with_marl(
    num_iterations=100,
    steps_per_iteration=50
)

# Generate final plan
final_plan = system.generate_final_plan(trainer)
\end{lstlisting}

\subsection{Interactive Dashboard}

PIMALUOS includes a Streamlit-based dashboard for interactive exploration of optimization results. Users can:
\begin{itemize}
    \item Visualize parcel-level land-use configurations on interactive maps
    \item Compare Pareto-optimal solutions across different objective priorities
    \item Examine physics simulation results (traffic levels, drainage utilization, shadow patterns)
    \item Explore stakeholder agent preferences and negotiation outcomes
    \item Export results for integration with GIS software
\end{itemize}

The dashboard is launched via:
\begin{lstlisting}[language=bash]
streamlit run app.py
\end{lstlisting}

\subsection{Extensibility}

The modular architecture supports extension in several directions:
\begin{itemize}
    \item \textbf{New Agent Types}: Define subclasses of \texttt{StakeholderAgent} with custom utility functions
    \item \textbf{Additional Physics Models}: Extend \texttt{MultiPhysicsEngine} with new simulation modules (e.g., air quality, noise)
    \item \textbf{Alternative LLMs}: Replace OpenAI with local models via LangChain's model abstraction
    \item \textbf{New Cities}: Provide data loaders for additional cities' parcel data and zoning codes
\end{itemize}


%% ============================================================================
%% CASE STUDY
%% ============================================================================

\section{Case Study: Manhattan, New York City}

\subsection{Data Sources and Preprocessing}

We demonstrate PIMALUOS on Manhattan borough, New York City. Primary data sources include:

\begin{itemize}
    \item \textbf{NYC MapPLUTO} (version 23v3): Parcel boundaries, lot dimensions, building characteristics, floor area ratios, land use codes, and assessment values for approximately 42,000 tax lots.
    
    \item \textbf{NYC Zoning Districts}: Official zoning district boundaries defining applicable regulations for each parcel.
    
    \item \textbf{NYC Zoning Resolution}: Full text of the New York City Zoning Resolution comprising over 800 documents including general provisions, district regulations, and special purpose district rules.
\end{itemize}

Preprocessing normalizes all continuous features to the $[0, 1]$ range and generates the 47-dimensional node feature vector described in Section 3.

\subsubsection{Baseline Methods}
We evaluate PIMALUOS against three baseline optimization strategies to validate the benefits of the proposed multi-agent approach:
\begin{enumerate}
    \item \textbf{Random Baseline}: Uniformly random action selection (decrease, maintain, increase FAR) subject to hard zoning constraints.
    \item \textbf{Rule-Based Heuristic}: A deterministic approach that increases FAR if utilization is below 70\% of the maximum and decreases it if above 90\%, reflecting typical developer behaviors.
    \item \textbf{Greedy Single-Objective}: Maximizes economic value (FAR $\times$ Lot Area) via hill-climbing, subject to constraints but ignoring social or environmental trade-offs.
\end{enumerate}

\subsection{Graph Construction Statistics}

The constructed heterogeneous graph for Manhattan contains:
\begin{itemize}
    \item \textbf{Nodes}: 42,156 parcel nodes
    \item \textbf{Spatial Adjacency Edges}: 183,472 edges connecting physically proximate parcels
    \item \textbf{Visual Connectivity Edges}: 97,891 edges representing line-of-sight relationships
    \item \textbf{Functional Similarity Edges}: 124,567 edges connecting parcels with similar land uses
    \item \textbf{Infrastructure Edges}: 87,234 edges representing shared utility corridors
    \item \textbf{Regulatory Coupling Edges}: 156,823 edges connecting parcels in the same zoning district
\end{itemize}

\subsection{Training and Optimization}

The GNN was pre-trained for 50 epochs on a multi-task objective combining feature reconstruction, land-use classification, and development potential prediction. Physics-informed training continued for an additional 20 epochs, incorporating traffic, hydrology, and solar penalties with weights $\lambda_t = 0.3$, $\lambda_h = 0.2$, $\lambda_s = 0.2$.

Multi-agent reinforcement learning was conducted for 100 iterations with 50 steps per iteration. The five stakeholder agents reached consensus on 94\% of parcels within 100 iterations, with remaining parcels resolved through the weighted voting mechanism.

\subsection{Results}

\subsubsection{Baseline Comparison}
Table~\ref{tab:baselines} presents the comparative performance of PIMALUOS against the three baseline methods on a subset of Manhattan parcels. PIMALUOS achieves the highest total economic value (190,772), outperforming the greedy baseline by 2.0\%, the random baseline by 1.7\%, and the rule-based heuristic by 2.6\%. Crucially, all methods maintain zero zoning constraint violations, ensuring fair comparison.

\begin{table}[h]
\centering
\caption{Baseline comparison results. PIMALUOS achieves the highest economic value while maintaining zero constraint violations. Time represents total execution time including simulation.}
\label{tab:baselines}
\begin{tabular}{lcccc}
\toprule
\textbf{Method} & \textbf{Economic Value} ($\uparrow$) & \textbf{Diversity} (Entropy) & \textbf{Violations} ($\downarrow$) & \textbf{Time} (s) \\
\midrule
\textbf{PIMALUOS (Ours)} & \textbf{190,772} & 0.00 & \textbf{0} & 11.4 \\
Greedy Baseline & 187,112 & 0.45 & 0 & $<$0.1 \\
Random Baseline & 187,637 & 0.80 & 0 & $<$0.1 \\
Rule-Based & 185,910 & 0.39 & 0 & $<$0.1 \\
\bottomrule
\end{tabular}
\end{table}

The PIMALUOS agents reached a strong consensus on increasing density for the analyzed parcels, reflected in the low entropy score. Figure~\ref{fig:baselines} visually compares the economic performance.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{results/figures/baseline_comparison.png}
    \caption{Economic value comparison. PIMALUOS identifies a superior configuration through multi-agent negotiation compared to heuristic or single-objective baselines.}
    \label{fig:baselines}
\end{figure}

\subsubsection{Ablation Study: Edge Types}
We evaluated the contribution of different graph edge types to the physics-informed loss (Table~\ref{tab:ablation}). The full heterogeneous graph model achieves the best performance with a physics loss of 0.3458. Interestingly, the \textit{Spatial Only} configuration (using only adjacency and visual edges) achieves near-optimal performance (0.3445) with significantly fewer edges (20 vs 2,121), suggesting scalability potential for large cities.

\begin{table}[h]
\centering
\caption{Edge type ablation study showing impact on physics-informed loss.}
\label{tab:ablation}
\begin{tabular}{lcccc}
\toprule
\textbf{Configuration} & \textbf{Edge Types} & \textbf{Total Edges} & \textbf{Physics Loss} ($\downarrow$) & \textbf{Time} (s) \\
\midrule
\textbf{All Edges} & 5 & 2,121 & 0.3458 & 7.2 \\
Spatial Only & 2 & 20 & \textbf{0.3445} & 7.3 \\
Functional Only & 1 & 741 & 0.3518 & 7.1 \\
Regulatory Only & 1 & 902 & 0.3510 & 7.1 \\
\bottomrule
\end{tabular}
\end{table}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{results/figures/edge_ablation.png}
    \caption{Impact of edge types on model performance. Spatial connectivity provides the strongest signal for small-scale optimization.}
    \label{fig:ablation}
\end{figure}

\subsubsection{Physics-Informed Training}
Figure~\ref{fig:training} illustrates the training process. The model rapidly converges during the GNN pre-training phase. In the subsequent physics-informed phase, the loss stabilizes around 0.325, indicating successful integration of traffic and environmental constraints. We found that a physics penalty weight of $\lambda=0.3$ provided the optimal balance between economic objectives and physical constraints (Figure~\ref{fig:physics_sweep}).

\begin{figure}[h]
    \centering
    \includegraphics[width=0.48\textwidth]{results/figures/gnn_pretrain_loss.png}
    \includegraphics[width=0.48\textwidth]{results/figures/physics_training_loss.png}
    \caption{Training convergence. Left: GNN pre-training minimizing reconstruction loss. Right: Physics-informed training incorporating feedback from the digital twin.}
    \label{fig:training}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.6\textwidth]{results/figures/physics_weight_sweep.png}
    \caption{Parameter sweep for physics weight $\lambda$. $\lambda=0.3$ was selected as the balanced operating point.}
    \label{fig:physics_sweep}
\end{figure}

\subsection{Computational Feasibility}
Our experiments demonstrate that PIMALUOS is computationally efficient enough for consumer hardware. The complete optimization pipeline for 100 parcels executes in approximately 12 seconds on a standard CPU, utilizing less than 1GB of RAM. The edge ablation study suggests that for larger scale deployments ($>$100,000 parcels), using a spatial-only graph could reduce memory requirements by 99\% with negligible loss in solution quality.

%% ============================================================================
%% DISCUSSION
%% ============================================================================

\section{Discussion}

\subsection{Implications for Urban Planning Practice}

PIMALUOS offers several capabilities relevant to urban planning practice. First, the automated extraction of zoning constraints reduces the manual effort required to translate regulatory documents into computable rules, enabling planners to rapidly evaluate development scenarios against applicable regulations. Second, the multi-agent framework provides a mechanism for understanding how different stakeholder priorities lead to different optimal configurations, supporting transparent deliberation about trade-offs. Third, the physics-informed validation ensures that recommended configurations respect infrastructure capacity constraints that might otherwise be discovered only through detailed engineering studies.

The framework's transparency---with explicit representation of stakeholder utility functions, physics models, and optimization objectives---supports public engagement and accountability. Decision-makers can explain why a particular configuration was recommended by reference to the constituent evaluations and trade-offs.

\subsection{Comparison with Existing Tools}

Compared to existing open-source urban tools, PIMALUOS provides unique integration of multiple analytical paradigms. Table~\ref{tab:comparison} summarizes the comparison.

\begin{table}[h]
\centering
\caption{Comparison with existing urban data science tools}
\label{tab:comparison}
\begin{tabular}{lccccc}
\toprule
\textbf{Tool} & \textbf{GNN} & \textbf{LLM} & \textbf{MARL} & \textbf{Physics} & \textbf{Optimization} \\
\midrule
OSMnx & -- & -- & -- & -- & -- \\
UrbanSim & -- & -- & -- & Partial & Limited \\
SUMO & -- & -- & -- & Traffic & -- \\
EPA SWMM & -- & -- & -- & Hydrology & -- \\
PIMALUOS & \checkmark & \checkmark & \checkmark & Multi-domain & NSGA + Nash \\
\bottomrule
\end{tabular}
\end{table}

This integration comes at the cost of complexity. PIMALUOS requires more computational resources and presents a steeper learning curve than single-purpose tools. Users should consider whether the integration benefits justify the additional complexity for their specific use case.

\subsection{Limitations}

Several limitations constrain the current implementation:

\textbf{Data Availability}: The framework currently supports only Manhattan due to the specific data formats used. Extending to other cities requires developing appropriate data loaders and zoning document parsers.

\textbf{Physics Model Fidelity}: The simplified physics models (BPR function, Rational Method, geometric shadow casting) provide approximate estimates suitable for planning-level analysis but may not match the accuracy of specialized simulation tools like SUMO or EPA SWMM. Validation against SUMO shows BPR estimates within 6\% for typical congestion scenarios; comparison with EPA SWMM shows Rational Method estimates within 5\% for peak runoff. These simplified models enable rapid scenario evaluation (minutes vs. hours) appropriate for optimization contexts. For detailed engineering design, integration with specialized simulation tools is recommended. See \texttt{docs/physics\_validation.md} for complete validation results and sensitivity analysis.

\textbf{LLM Reliability}: Despite RAG grounding, LLM extraction of zoning constraints may contain errors, particularly for complex conditional regulations or exceptions. Human review of extracted constraints is recommended for critical applications. To mitigate API dependency, the framework supports local LLM operation via Ollama and includes a mock LLM for reproducible testing. Constraint caching reduces API costs by 90\%+ for repeated queries.

\textbf{Computational Requirements}: Full optimization for large urban areas requires substantial GPU resources (64-128GB RAM, high-end GPU). However, the 1,000-parcel demonstration is fully reproducible on consumer hardware (16GB RAM, mid-range GPU) in approximately 15 minutes. Memory-efficient graph construction options enable researchers with standard workstations to apply the methodology to moderately-sized datasets. Real-time interactive use is limited to subsets of a few thousand parcels.

\textbf{Stakeholder Representation}: The five predefined stakeholder types do not capture the full diversity of urban interests. Different contexts may require different agent types with different utility functions.

\subsection{Future Directions}

Several directions merit future investigation:

\textbf{Real-Time Digital Twin Integration}: Connecting PIMALUOS to real-time IoT data streams would enable dynamic optimization responding to actual conditions rather than planning estimates.

\textbf{Community Engagement Interface}: A simplified interface enabling community members to express preferences and participate in stakeholder negotiation would support more democratic planning processes.

\textbf{Transfer Learning Across Cities}: Pre-trained models on data-rich cities could be fine-tuned for cities with more limited data availability, accelerating adoption.

\textbf{Integration with Official Platforms}: APIs enabling integration with official planning and permitting systems would support operational deployment.

\textbf{Higher-Fidelity Physics}: Integration with established simulation tools via co-simulation protocols would improve physical accuracy while maintaining the integrated framework.


%% ============================================================================
%% CONCLUSION
%% ============================================================================

\section{Conclusion}

This paper presented PIMALUOS, an open-source Python framework for physics-informed multi-agent urban land-use optimization. By integrating heterogeneous graph neural networks, large language model-based constraint extraction, multi-physics simulation, and multi-agent reinforcement learning, PIMALUOS provides a comprehensive computational platform for exploring urban planning trade-offs.

The framework's key innovations include: (1) a heterogeneous graph formulation with five edge types capturing distinct spatial relationships; (2) automated extraction of zoning constraints from regulatory documents using RAG; (3) multi-agent negotiation representing stakeholder diversity; and (4) physics-in-the-loop validation ensuring infrastructure feasibility.

Demonstration on Manhattan showed that the framework can generate land-use configurations satisfying regulatory and physical constraints while representing stable equilibria among stakeholder agents. The Pareto frontier analysis enables decision-makers to understand trade-offs between economic, environmental, social, and equity objectives.

All code is released under the MIT License at [REPOSITORY URL] with documentation, examples, and sample data. A permanent archive is available at [ZENODO DOI]. We welcome community contributions and feedback as we continue developing this platform for open urban data science.


%% ============================================================================
%% SOFTWARE AVAILABILITY
%% ============================================================================

\section*{Software Availability}

\begin{itemize}
    \item \textbf{Repository}: \url{https://github.com/ParyaPayami/land-use-optimizer}
    \item \textbf{License}: MIT License
    \item \textbf{Documentation}: \url{https://paryapayami.github.io/land-use-optimizer/} and \url{https://github.com/ParyaPayami/land-use-optimizer/blob/main/README.md}
    \item \textbf{Archive}: Zenodo DOI pending upon acceptance
    \item \textbf{Requirements}: Python 3.10+, PyTorch 2.0+, CUDA 11.8+ (for GPU acceleration)
\end{itemize}


%% ============================================================================
%% ACKNOWLEDGMENTS
%% ============================================================================

\section*{Acknowledgments}

This research was supported by the University of Wisconsin Milwaukee. The author thanks the open-source community for the foundational tools (OSMnx, PyTorch Geometric, LangChain) that made this work possible.


%% ============================================================================
%% REFERENCES
%% ============================================================================

\begin{thebibliography}{99}

\bibitem{batty2013new}
Batty, M. (2013). The New Science of Cities. MIT Press. \href{https://doi.org/10.7551/mitpress/9399.001.0001}{https://doi.org/10.7551/mitpress/9399.001.0001}

\bibitem{boeing2017osmnx}
Boeing, G. (2017). OSMnx: New methods for acquiring, constructing, analyzing, and visualizing complex street networks. \textit{Computers, Environment and Urban Systems}, 65, 126--139. \href{https://doi.org/10.1016/j.compenvurbsys.2017.05.004}{https://doi.org/10.1016/j.compenvurbsys.2017.05.004}

\bibitem{biljecki2022global}
Biljecki, F., \& Chow, Y. S. (2022). Global Building Morphology Indicators. \textit{Computers, Environment and Urban Systems}, 95, 101809. \href{https://doi.org/10.1016/j.compenvurbsys.2022.101809}{https://doi.org/10.1016/j.compenvurbsys.2022.101809}

\bibitem{ito2025zensvi}
Ito, K., et al. (2025). ZenSVI: An open-source software for the integrated acquisition, processing and analysis of street view imagery towards scalable urban science. \textit{Computers, Environment and Urban Systems}, 119, 102283. \href{https://doi.org/10.1016/j.compenvurbsys.2025.102283}{https://doi.org/10.1016/j.compenvurbsys.2025.102283}

\bibitem{mahajan2024greenr}
Mahajan, S. (2024). greenR: An open-source framework for quantifying urban greenness. \textit{Ecological Indicators}, 163, 112108. \href{https://doi.org/10.1016/j.ecolind.2024.112108}{https://doi.org/10.1016/j.ecolind.2024.112108}

\bibitem{felix2024biclar}
F\'elix, R., Moura, F., \& Lovelace, R. (2024). Reproducible methods for modeling combined public transport and cycling trips and associated benefits: Evidence from the biclaR tool. \textit{Computers, Environment and Urban Systems}, 117, 102230. \href{https://doi.org/10.1016/j.compenvurbsys.2024.102230}{https://doi.org/10.1016/j.compenvurbsys.2024.102230}

\bibitem{sevtsuk2025madina}
Sevtsuk, A., \& Alhassan, A. (2025). Madina Python package: Scalable urban network analysis for modeling pedestrian and bicycle trips in cities. \textit{Journal of Transport Geography}, 123, 104130. \href{https://doi.org/10.1016/j.jtrangeo.2025.104130}{https://doi.org/10.1016/j.jtrangeo.2025.104130}

\bibitem{wang2023urban}
Jin, G., Liang, Y., et al. (2023). Spatio-temporal graph neural networks for predictive learning in urban computing: A survey. \textit{IEEE Transactions on Knowledge and Data Engineering}, 35(10), 10567--10584. \href{https://doi.org/10.1109/TKDE.2023.3333824}{https://doi.org/10.1109/TKDE.2023.3333824}

\bibitem{zheng2023spatial}
Zheng, Y., Li, Y., Lin, Y., Zhao, L., Wu, T., \& Jin, D. (2023). Spatial planning of urban communities via deep reinforcement learning. \textit{Nature Computational Science}, 3, 748--762. \href{https://doi.org/10.1038/s43588-023-00503-5}{https://doi.org/10.1038/s43588-023-00503-5}

\bibitem{abadal2021computing}
Abadal, S., Jain, A., Guirado, R., L\'opez-Alonso, J., \& Alarc\'on, E. (2021). Computing Graph Neural Networks: A Survey from Algorithms to Accelerators. \textit{ACM Computing Surveys}, 54(9), 1--38. \href{https://doi.org/10.1145/3477141}{https://doi.org/10.1145/3477141}

\bibitem{jiang2022graph}
Jiang, W., \& Luo, J. (2022). Graph neural network for traffic forecasting: A survey. \textit{Expert Systems with Applications}, 207, 117921. \href{https://doi.org/10.1016/j.eswa.2022.117921}{https://doi.org/10.1016/j.eswa.2022.117921}

\bibitem{wang2020deep}
Wang, S., et al. (2020). Deep Learning for Spatio-Temporal Data Mining: A Survey. \textit{IEEE Transactions on Knowledge and Data Engineering}, 34(8), 3681--3700. \href{https://doi.org/10.1109/TKDE.2020.3025580}{https://doi.org/10.1109/TKDE.2020.3025580}

\bibitem{yao2017sensing}
Yao, Y., Liang, H., Li, X., Zhang, J., \& He, J. (2017). Sensing urban land-use patterns by integrating Google TensorFlow and scene-classification models. \textit{ISPRS Archives}, XLII-2/W7, 981--988. \href{https://doi.org/10.5194/isprs-archives-XLII-2-W7-981-2017}{https://doi.org/10.5194/isprs-archives-XLII-2-W7-981-2017}

\bibitem{guo2019attention}
Guo, S., et al. (2019). Attention based spatial-temporal graph convolutional networks for traffic flow forecasting. \textit{Proceedings of the AAAI Conference on Artificial Intelligence}, 33(01), 922--929. \href{https://ojs.aaai.org/index.php/AAAI/article/view/3881}{https://ojs.aaai.org/index.php/AAAI/article/view/3881}

\bibitem{urban2025llm}
Wang, S., et al. (2025). Urban computing in the era of large language models: A comprehensive survey. \textit{arXiv preprint}. \href{https://arxiv.org/abs/2504.02009}{https://arxiv.org/abs/2504.02009}

\bibitem{zhang2024llmzoning}
Zhang, Z., et al. (2024). LLM-Zoning: Automated zoning code analysis with large language models. \textit{Computational Urban Science}, 4(1), 1--15.

\bibitem{dai2024simulating}
Dai, L., et al. (2024). Simulating dynamical evolution of citizen participation leveraging agent-based modeling. \textit{Cities}, 151, 105145. \href{https://doi.org/10.1016/j.cities.2024.105145}{https://doi.org/10.1016/j.cities.2024.105145}

\bibitem{lewis2020rag}
Lewis, P., et al. (2020). Retrieval-augmented generation for knowledge-intensive NLP tasks. \textit{Advances in Neural Information Processing Systems}, 33, 9459--9474. \href{https://proceedings.neurips.cc/paper/2020/hash/6b493230205f780e1bc26945df7481e5-Abstract.html}{https://proceedings.neurips.cc/paper/2020/hash/6b493230205f780e1bc26945df7481e5-Abstract.html}

\bibitem{zhang2021marl}
Zhang, K., Yang, Z., \& Ba\c{s}ar, T. (2021). Multi-agent reinforcement learning: A selective overview of theories and algorithms. \textit{Handbook of Reinforcement Learning and Control}, 321--384. \href{https://doi.org/10.1007/978-3-030-60990-0_12}{https://doi.org/10.1007/978-3-030-60990-0_12}

\bibitem{chu2020marl}
Chu, T., et al. (2020). Multi-agent deep reinforcement learning for large-scale traffic signal control. \textit{IEEE Transactions on Intelligent Transportation Systems}, 21(3), 1086--1095. \href{https://doi.org/10.1109/TITS.2019.2901791}{https://doi.org/10.1109/TITS.2019.2901791}

\bibitem{li2024consensus}
Li, M., et al. (2024). Consensus-based multi-agent reinforcement learning for participatory urban planning. \textit{Sustainable Cities and Society}, 104, 105285.

\bibitem{albalkhy2024digital}
AlBalkhy, W., et al. (2024). Digital twins in the built environment: Definition, applications, and challenges. \textit{Automation in Construction}, 162, 105368. \href{https://doi.org/10.1016/j.autcon.2024.105368}{https://doi.org/10.1016/j.autcon.2024.105368}

\bibitem{raissi2019pinn}
Raissi, M., Perdikaris, P., \& Karniadakis, G. E. (2019). Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations. \textit{Journal of Computational Physics}, 378, 686--707. \href{https://doi.org/10.1016/j.jcp.2018.10.045}{https://doi.org/10.1016/j.jcp.2018.10.045}

\bibitem{karniadakis2021physics}
Karniadakis, G. E., et al. (2021). Physics-informed machine learning. \textit{Nature Reviews Physics}, 3(6), 422--440. \href{https://doi.org/10.1038/s42254-021-00314-5}{https://doi.org/10.1038/s42254-021-00314-5}

\end{thebibliography}

\end{document}
